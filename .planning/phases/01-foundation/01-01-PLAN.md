---
name: "Refactor PDF Extraction Architecture"
depends_on: []
---

# Plan: Refactor PDF Extraction Architecture

**Phase:** 1 (Foundation & Cleanup)
**Goal:** Modularize the codebase to support future features like hybrid extraction.

## Strategy

1.  **Create Modular Structure:** Set up `src/` directory and empty modules.
2.  **Migrate Logic:** Move functions from `pdf_to_excel_tables.py` to respective modules.
3.  **Refactor Entry Point:** Update `pdf_to_excel_tables.py` to import from `src`.
4.  **Add Types & Tests:** Add type hints and basic tests.

## Task Breakdown

### Wave 1: Setup

- [ ] Create `src/` directory with `__init__.py` <!-- id: 0 -->
- [ ] Create `src/extractor.py` (empty) <!-- id: 1 -->
- [ ] Create `src/writer.py` (empty) <!-- id: 2 -->
- [ ] Create `src/styles.py` (empty) <!-- id: 3 -->

### Wave 2: Migration

- [ ] Move `create_styles` to `src/styles.py` <!-- id: 4 -->
- [ ] Move `extract_tables_from_pdf` to `src/extractor.py` <!-- id: 5 -->
- [ ] Move `create_excel_from_tables` to `src/writer.py` <!-- id: 6 -->

### Wave 3: Integration

- [ ] Update `pdf_to_excel_tables.py` to use `src` modules <!-- id: 7 -->
- [ ] Update `batch_extract_tables.py` to use `src` modules <!-- id: 8 -->
- [ ] Verify `python pdf_to_excel_tables.py` still works <!-- id: 9 -->

### Wave 4: Cleanup

- [ ] Add type hints to all functions <!-- id: 10 -->
- [ ] Create `tests/test_extraction.py` <!-- id: 11 -->

## Verification Criteria

- [ ] `pdf_to_excel_tables.py` runs without errors on sample PDF.
- [ ] `batch_extract_tables.py` runs without errors.
- [ ] Code is organized in `src/` modules.
- [ ] `mypy` (if installed) or manual check shows type hints.
