---
name: "Improve Table Extraction Accuracy"
depends_on: ["Phase 1"]
---

# Plan: Improve Table Extraction Accuracy

**Phase:** 2
**Goal:** Fix row merging issues by tuning `pdfplumber` settings.

## Strategy

1.  **Analyze `pdfplumber` Settings:** Focus on `horizontal_strategy`. The default is often effective but fails when lines are missing. `horizontal_strategy="text"` works better for tables with implied rows (whitespace).
2.  **Implement Robust Extraction:**
    - Use `intersection_y_tolerance` to catch slightly misaligned borders.
    - Explicitly set `horizontal_strategy="text"` as a forceful way to separate rows based on text lines.
3.  **Refine Key Logic:**
    - Update `src/extractor.py` to use these tuned settings.

## Task Breakdown

### Wave 1: Implementation
- [ ] Modify `src/extractor.py` to use explicit `table_settings`. <!-- id: 0 -->
- [ ] Define a `DEFAULT_TABLE_SETTINGS` constant containing:
    - `vertical_strategy`: "lines" (trust vertical lines for columns)
    - `horizontal_strategy`: "text" (trust text position for rows, ignores missing horiz lines)
    - `snap_tolerance`: 3
    - `join_tolerance`: 3
    - `edge_min_length`: 10
    - `min_words_vertical`: 3 (ignore tiny noise)

### Wave 2: Validation
- [ ] Run `python pdf_to_excel_tables.py` on sample PDFs against the new logic. <!-- id: 1 -->

## Verification
- User to verify if the output excel now correctly separates the rows.
